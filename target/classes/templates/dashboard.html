
<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8" />-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0" />-->
<!--    <title>Smart Agriculture Advisor - Dashboard</title>-->
<!--    <script src="https://cdn.tailwindcss.com"></script>-->
<!--    <link-->
<!--            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"-->
<!--            rel="stylesheet"-->
<!--    />-->
<!--    <link rel="stylesheet" href="/static/css/dash.css">-->
<!--</head>-->
<!--<body class="p-4">-->
<!--<div class="min-h-screen fade-in">-->
<!--    &lt;!&ndash; Navbar &ndash;&gt;-->
<!--    <nav class="nav-blur shadow-lg mb-6 rounded-lg">-->
<!--        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">-->
<!--            <div class="flex justify-between h-16">-->
<!--                <div class="flex items-center">-->
<!--                    <i class="fas fa-leaf text-green-600 text-2xl mr-2"></i>-->
<!--                    <span class="text-xl font-bold text-gray-800">AgriConnect</span>-->
<!--                </div>-->
<!--                <div class="flex items-center space-x-4">-->
<!--                    <a href="/api/Agriconnect" class="custom-button secondary-button">-->
<!--                        <i class="fas fa-home mr-1"></i> Home-->
<!--                    </a>-->
<!--                    <a href="/api/logout" class="custom-button primary-button">-->
<!--                        <i class="fas fa-sign-out-alt mr-1"></i> Logout-->
<!--                    </a>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </nav>-->

<!--    &lt;!&ndash; Main Content &ndash;&gt;-->
<!--    <div class="glass-container p-6 mb-6 slide-in">-->
<!--        <h1 class="text-2xl font-bold text-gray-800 mb-2">-->
<!--            Agricultural Market Dashboard-->
<!--        </h1>-->
<!--        <p class="text-gray-600">-->
<!--            Monitor crop prices and market trends across different regions-->
<!--        </p>-->
<!--    </div>-->

<!--    &lt;!&ndash; Table Section &ndash;&gt;-->
<!--    <div class="table-container slide-up">-->
<!--        <div class="p-6 border-b border-gray-200">-->
<!--            <div class="flex justify-between items-center">-->
<!--                <h2 class="text-lg font-semibold text-gray-800">Market Prices</h2>-->
<!--                <div class="flex space-x-2">-->
<!--                    <button class="custom-button secondary-button">-->
<!--                        <i class="fas fa-filter mr-1"></i> Filter-->
<!--                    </button>-->
<!--                    <button class="custom-button secondary-button">-->
<!--                        <i class="fas fa-download mr-1"></i> Export-->
<!--                    </button>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="overflow-x-auto">-->
<!--            <table class="custom-table">-->
<!--                <thead>-->
<!--                <tr>-->
<!--                    <th>State</th>-->
<!--                    <th>District</th>-->
<!--                    <th>Market</th>-->
<!--                    <th>Crop Name</th>-->
<!--                    <th>Arrival Date</th>-->
<!--                    <th>Minimum Price</th>-->
<!--                    <th>Maximum Price</th>-->
<!--                    <th>Suggested Price</th>-->
<!--                </tr>-->
<!--                </thead>-->
<!--                <tbody th:each="crop : ${cropList}">-->
<!--                <tr>-->
<!--                    <td th:text="${crop.state}"></td>-->
<!--                    <td th:text="${crop.district}"></td>-->
<!--                    <td th:text="${crop.market}"></td>-->
<!--                    <td th:text="${crop.cropName}"></td>-->
<!--                    <td th:text="${crop.arrivalDate}"></td>-->
<!--                    <td-->
<!--                            class="text-green-600 font-medium"-->
<!--                            th:text="${crop.minPrice}"-->
<!--                    ></td>-->
<!--                    <td-->
<!--                            class="text-green-600 font-medium"-->
<!--                            th:text="${crop.maxPrice}"-->
<!--                    ></td>-->
<!--                    <td-->
<!--                            class="text-blue-600 font-medium"-->
<!--                            th:text="${crop.suggestedPrice}"-->
<!--                    ></td>-->
<!--                </tr>-->
<!--                </tbody>-->
<!--            </table>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->
<!--</body>-->
<!--</html>-->
<!--<!DOCTYPE html>-->
<!--<html xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8" />-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0" />-->
<!--    <title>Smart Agriculture Advisor - Dashboard</title>-->
<!--    <script src="https://cdn.tailwindcss.com"></script>-->
<!--    <link-->
<!--            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"-->
<!--            rel="stylesheet"-->
<!--    />-->
<!--    <style>-->
<!--        body {-->
<!--            font-family: "Poppins", sans-serif;-->
<!--            background-color: rgb(157, 215, 157);-->
<!--            background-image: url('/static/images/farm-pattern.png');-->
<!--            background-repeat: no-repeat;-->
<!--            background-position: center center;-->
<!--            background-size: cover;-->
<!--            margin: 0;-->
<!--            min-height: 100vh;-->
<!--        }-->

<!--        .glass-container {-->
<!--            background: rgba(255, 255, 255, 0.9);-->
<!--            backdrop-filter: blur(10px);-->
<!--            border: 1px solid rgba(255, 255, 255, 0.2);-->
<!--            border-radius: 12px;-->
<!--        }-->

<!--        .nav-blur {-->
<!--            background: rgba(255, 255, 255, 0.8);-->
<!--            backdrop-filter: blur(10px);-->
<!--        }-->

<!--        .table-container {-->
<!--            background: rgba(255, 255, 255, 0.95);-->
<!--            border-radius: 12px;-->
<!--            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);-->
<!--            overflow: hidden;-->
<!--        }-->

<!--        /* Animations */-->
<!--        @keyframes fadeIn {-->
<!--            from {-->
<!--                opacity: 0;-->
<!--            }-->
<!--            to {-->
<!--                opacity: 1;-->
<!--            }-->
<!--        }-->

<!--        @keyframes slideIn {-->
<!--            from {-->
<!--                transform: translateY(-20px);-->
<!--                opacity: 0;-->
<!--            }-->
<!--            to {-->
<!--                transform: translateY(0);-->
<!--                opacity: 1;-->
<!--            }-->
<!--        }-->

<!--        @keyframes slideUp {-->
<!--            from {-->
<!--                transform: translateY(20px);-->
<!--                opacity: 0;-->
<!--            }-->
<!--            to {-->
<!--                transform: translateY(0);-->
<!--                opacity: 1;-->
<!--            }-->
<!--        }-->

<!--        @keyframes pulse {-->
<!--            0% {-->
<!--                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);-->
<!--            }-->
<!--            70% {-->
<!--                box-shadow: 0 0 0 10px rgba(16, 185, 129, 0);-->
<!--            }-->
<!--            100% {-->
<!--                box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);-->
<!--            }-->
<!--        }-->

<!--        .fade-in {-->
<!--            animation: fadeIn 1s ease-in-out;-->
<!--        }-->

<!--        .slide-in {-->
<!--            animation: slideIn 1s ease-in-out;-->
<!--        }-->

<!--        .slide-up {-->
<!--            animation: slideUp 1s ease-in-out;-->
<!--        }-->

<!--        .pulse {-->
<!--            animation: pulse 2s infinite;-->
<!--        }-->

<!--        /* Table Styles */-->
<!--        .custom-table {-->
<!--            width: 100%;-->
<!--            border-collapse: separate;-->
<!--            border-spacing: 0;-->
<!--        }-->

<!--        .custom-table th {-->
<!--            background: rgba(243, 244, 246, 0.8);-->
<!--            padding: 16px;-->
<!--            font-weight: 600;-->
<!--            text-transform: uppercase;-->
<!--            font-size: 0.99rem;-->
<!--            letter-spacing: 0.05em;-->
<!--            color: #4b5563;-->
<!--            border-bottom: 2px solid #e5e7eb;-->
<!--        }-->

<!--        .custom-table td {-->
<!--            padding: 16px;-->
<!--            border-bottom: 1px solid #e5e7eb;-->
<!--            text-align: center;-->
<!--            transition: all 0.2s ease;-->
<!--        }-->

<!--        .custom-table tr:hover td {-->
<!--            background: rgba(243, 244, 246, 0.5);-->
<!--        }-->

<!--        /* Button Styles */-->
<!--        .custom-button {-->
<!--            padding: 0.5rem 1rem;-->
<!--            border-radius: 0.5rem;-->
<!--            font-weight: 500;-->
<!--            transition: all 0.3s ease;-->
<!--        }-->

<!--        .primary-button {-->
<!--            background-color: #10b981;-->
<!--            color: white;-->
<!--        }-->

<!--        .primary-button:hover {-->
<!--            background-color: #059669;-->
<!--            transform: translateY(-1px);-->
<!--        }-->

<!--        .secondary-button {-->
<!--            background-color: #f3f4f6;-->
<!--            color: #4b5563;-->
<!--        }-->

<!--        .secondary-button:hover {-->
<!--            background-color: #e5e7eb;-->
<!--            transform: translateY(-1px);-->
<!--        }-->

<!--        /* Custom Scrollbar */-->
<!--        ::-webkit-scrollbar {-->
<!--            width: 8px;-->
<!--            height: 8px;-->
<!--        }-->

<!--        ::-webkit-scrollbar-track {-->
<!--            background: #f3f4f6;-->
<!--        }-->

<!--        ::-webkit-scrollbar-thumb {-->
<!--            background: #94a3b8;-->
<!--            border-radius: 4px;-->
<!--        }-->

<!--        ::-webkit-scrollbar-thumb:hover {-->
<!--            background: #64748b;-->
<!--        }-->

<!--        /* Dashboard stats */-->
<!--        .stat-card {-->
<!--            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.6));-->
<!--            border-radius: 12px;-->
<!--            border-left: 4px solid #10b981;-->
<!--            transition: all 0.3s ease;-->
<!--        }-->

<!--        .stat-card:hover {-->
<!--            transform: translateY(-5px);-->
<!--            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);-->
<!--        }-->

<!--        /* Filter dropdown */-->
<!--        .filter-dropdown {-->
<!--            position: absolute;-->
<!--            right: 0;-->
<!--            top: 100%;-->
<!--            background: white;-->
<!--            border-radius: 8px;-->
<!--            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);-->
<!--            width: 250px;-->
<!--            z-index: 10;-->
<!--            display: none;-->
<!--        }-->

<!--        .filter-dropdown.show {-->
<!--            display: block;-->
<!--            animation: slideIn 0.3s ease-out;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body class="p-4">-->
<!--<div class="min-h-screen fade-in">-->
<!--    &lt;!&ndash; Navbar &ndash;&gt;-->
<!--    <nav class="nav-blur shadow-lg mb-6 rounded-lg">-->
<!--        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">-->
<!--            <div class="flex justify-between h-16">-->
<!--                <div class="flex items-center">-->
<!--                    <i class="fas fa-leaf text-green-600 text-2xl mr-2 pulse"></i>-->
<!--                    <span class="text-xl font-bold text-gray-800">AgriConnect</span>-->
<!--                </div>-->
<!--                <div class="flex items-center space-x-4">-->
<!--                    <a href="/api/Agriconnect" class="custom-button secondary-button">-->
<!--                        <i class="fas fa-home mr-1"></i> Home-->
<!--                    </a>-->
<!--                    <a href="/api/logout" class="custom-button primary-button">-->
<!--                        <i class="fas fa-sign-out-alt mr-1"></i> Logout-->
<!--                    </a>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </nav>-->
<!--    &lt;!&ndash; Main Content &ndash;&gt;-->
<!--    <div class="glass-container p-6 mb-6 slide-in">-->
<!--        <div class="flex items-center justify-between">-->
<!--            <div>-->
<!--                <h1 class="text-2xl font-bold text-gray-800 mb-2">-->
<!--                    Agricultural Market Dashboard-->
<!--                </h1>-->
<!--                <p class="text-gray-600">-->
<!--                    Monitor crop prices and market trends across different regions-->
<!--                </p>-->
<!--            </div>-->
<!--            <div class="hidden md:block">-->
<!--                <div class="bg-green-100 text-green-800 px-4 py-2 rounded-full text-sm font-medium">-->
<!--                    <i class="fas fa-sync-alt mr-1"></i> Last updated: Today, 10:30 AM-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    &lt;!&ndash; Table Section &ndash;&gt;-->
<!--    <div class="table-container slide-up relative">-->
<!--        <div class="p-6 border-b border-gray-200">-->
<!--            <div class="flex justify-between items-center">-->
<!--                <h2 class="text-lg font-semibold text-gray-800">Market Prices</h2>-->
<!--                <div class="flex space-x-2">-->
<!--                    <button id="filterBtn" class="custom-button secondary-button relative">-->
<!--                        <i class="fas fa-filter mr-1"></i> Filter-->
<!--                    </button>-->
<!--                    <div id="filterDropdown" class="filter-dropdown p-4">-->
<!--                        <h3 class="font-medium text-gray-800 mb-3">Filter Options</h3>-->
<!--                        <div class="mb-3">-->
<!--                            <label class="block text-sm text-gray-700 mb-1">State</label>-->
<!--                            <label>-->
<!--                                <select class="w-full p-2 border rounded">-->
<!--                                    <option>All States</option>-->
<!--                                    <option>Maharashtra</option>-->
<!--                                    <option>Punjab</option>-->
<!--                                    <option>Karnataka</option>-->
<!--                                </select>-->
<!--                            </label>-->
<!--                        </div>-->
<!--                        <button class="w-full bg-green-600 text-white py-2 rounded">Apply Filters</button>-->
<!--                    </div>-->
<!--                    <button id="exportBtn" class="custom-button secondary-button">-->
<!--                        <i class="fas fa-download mr-1"></i> Export-->
<!--                    </button>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--        <div class="overflow-x-auto">-->
<!--            <table class="custom-table" id="marketTable">-->
<!--                <thead>-->
<!--                <tr>-->
<!--                    <th>State</th>-->
<!--                    <th>District</th>-->
<!--                    <th>Market</th>-->
<!--                    <th>Crop Name</th>-->
<!--                    <th>Arrival Date</th>-->
<!--                    <th>Minimum Price</th>-->
<!--                    <th>Maximum Price</th>-->
<!--                    <th>Suggested Price</th>-->
<!--                </tr>-->
<!--                </thead>-->
<!--                <tbody th:each="crop : ${cropList}">-->
<!--                <tr>-->
<!--                    <td th:text="${crop.state}"></td>-->
<!--                    <td th:text="${crop.district}"></td>-->
<!--                    <td th:text="${crop.market}"></td>-->
<!--                    <td th:text="${crop.cropName}"></td>-->
<!--                    <td th:text="${crop.arrivalDate}"></td>-->
<!--                    <td-->
<!--                            class="text-green-600 font-medium"-->
<!--                            th:text="${crop.minPrice}"-->
<!--                    ></td>-->
<!--                    <td-->
<!--                            class="text-green-600 font-medium"-->
<!--                            th:text="${crop.maxPrice}"-->
<!--                    ></td>-->
<!--                    <td-->
<!--                            class="text-blue-600 font-medium"-->
<!--                            th:text="${crop.suggestedPrice}"-->
<!--                    ></td>-->
<!--                </tr>-->
<!--                </tbody>-->
<!--            </table>-->
<!--        </div>-->
<!--        <div class="p-4 text-center text-sm text-gray-500">-->
<!--            Showing less <a href="#" class="text-green-600 hover:underline">View all</a>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<script>-->
<!--    // Filter button toggle-->
<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        const filterBtn = document.getElementById('filterBtn');-->
<!--        const filterDropdown = document.getElementById('filterDropdown');-->

<!--        filterBtn.addEventListener('click', function() {-->
<!--            filterDropdown.classList.toggle('show');-->
<!--        });-->

<!--        // Close dropdown when clicking outside-->
<!--        document.addEventListener('click', function(event) {-->
<!--            if (!filterBtn.contains(event.target) && !filterDropdown.contains(event.target)) {-->
<!--                filterDropdown.classList.remove('show');-->
<!--            }-->
<!--        });-->

<!--        // Export functionality-->
<!--        const exportBtn = document.getElementById('exportBtn');-->
<!--        exportBtn.addEventListener('click', function() {-->
<!--            exportTableToCSV('agricultural_market_data.csv');-->
<!--        });-->
<!--    });-->

<!--    // Function to export table data to CSV-->
<!--    function exportTableToCSV(filename) {-->
<!--        const table = document.getElementById('marketTable');-->
<!--        let csv = [];-->
<!--        const rows = table.querySelectorAll('tr');-->

<!--        for (let i = 0; i < rows.length; i++) {-->
<!--            const row = [], cols = rows[i].querySelectorAll('td, th');-->

<!--            for (let j = 0; j < cols.length; j++) {-->
<!--                // Get the text content and remove any formatting-->
<!--                let data = cols[j].textContent.replace(/(\r\n|\n|\r)/gm, '').trim();-->
<!--                // Escape double-quotes with double-quotes-->
<!--                data = data.replace(/"/g, '""');-->
<!--                // Add quotes around the field-->
<!--                row.push('"' + data + '"');-->
<!--            }-->
<!--            csv.push(row.join(','));-->
<!--        }-->

<!--        // Create a CSV string-->
<!--        const csvString = csv.join('\n');-->

<!--        // Create a download link-->
<!--        const link = document.createElement('a');-->
<!--        link.style.display = 'none';-->
<!--        link.setAttribute('href', 'data:text/csv;charset=utf-8,' + encodeURIComponent(csvString));-->
<!--        link.setAttribute('download', filename);-->
<!--        document.body.appendChild(link);-->

<!--        // Click the link to trigger the download-->
<!--        link.click();-->

<!--        // Remove the link-->
<!--        document.body.removeChild(link);-->

<!--        // Show success notification-->
<!--        showNotification('Data exported successfully!');-->
<!--    }-->

<!--    // Notification function-->
<!--    function showNotification(message) {-->
<!--        // Create notification element-->
<!--        const notification = document.createElement('div');-->
<!--        notification.className = 'fixed bottom-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg';-->
<!--        notification.style.animation = 'slideIn 0.3s ease-out';-->
<!--        notification.innerHTML = `-->
<!--            <div class="flex items-center">-->
<!--                <i class="fas fa-check-circle mr-2"></i>-->
<!--                <span>${message}</span>-->
<!--            </div>-->
<!--        `;-->

<!--        // Add to document-->
<!--        document.body.appendChild(notification);-->

<!--        // Remove after 3 seconds-->
<!--        setTimeout(() => {-->
<!--            notification.style.animation = 'slideOut 0.3s ease-in forwards';-->
<!--            setTimeout(() => {-->
<!--                document.body.removeChild(notification);-->
<!--            }, 300);-->
<!--        }, 3000);-->
<!--    }-->

<!--    // Add animation for notification disappearing-->
<!--    const style = document.createElement('style');-->
<!--    style.textContent = `-->
<!--        @keyframes slideOut {-->
<!--            from {-->
<!--                transform: translateX(0);-->
<!--                opacity: 1;-->
<!--            }-->
<!--            to {-->
<!--                transform: translateX(20px);-->
<!--                opacity: 0;-->
<!--            }-->
<!--        }-->
<!--    `;-->
<!--    document.head.appendChild(style);-->
<!--</script>-->
<!--</body>-->
<!--</html>-->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Smart Agriculture Advisor - Dashboard</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js for potential future visualizations -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Font Awesome for icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <style>
        /* Base body styling with farmer-friendly gradient */
        body {
            font-family: "Poppins", sans-serif;
            background: linear-gradient(135deg, #a7e8a7, #6bd16b);
            margin: 0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Glassmorphism for containers */
        .glass-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(12px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        /* Navbar styling */
        .nav-blur {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Table container styling */
        .table-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes bounceIn {
            0% { transform: scale(0.95); opacity: 0; }
            60% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); }
        }

        .fade-in { animation: fadeIn 0.8s ease-in-out; }
        .bounce-in { animation: bounceIn 0.6s ease-out; }

        /* Table header styling */
        .custom-table th {
            background: #f0fdf4;
            padding: 1rem;
            font-weight: 600;
            color: #1f2937;
            border-bottom: 2px solid #e5e7eb;
        }

        /* Table cell styling */
        .custom-table td {
            padding: 1rem;
            border-bottom: 1px solid #f3f4f6;
            text-align: center;
            transition: all 0.3s ease;
        }

        .custom-table tr:hover td {
            background: #f9fafb;
            transform: scale(1.02);
        }

        /* Button styling */
        .custom-button {
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 14px rgba(0, 0, 0, 0.1);
        }

        .primary-button {
            background: #16a34a;
            color: white;
        }

        .primary-button:hover {
            background: #15803d;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(22, 163, 74, 0.3);
        }

        /* Filter dropdown styling */
        .filter-dropdown {
            background: white;
            border-radius: 15px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
            width: 300px;
            padding: 1.5rem;
        }

        /* Stat card styling */
        .stat-card {
            background: linear-gradient(135deg, #fff, #f9fafb);
            border-radius: 15px;
            border-left: 5px solid #16a34a;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>
<body class="p-6">
<div class="min-h-screen fade-in">
    <!-- Navigation Bar -->
    <nav class="nav-blur shadow-xl mb-8 rounded-2xl">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <i class="fas fa-tractor text-green-600 text-3xl mr-3 animate-pulse"></i>
                    <span class="text-2xl font-bold text-gray-800">AgriConnect</span>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="custom-button secondary-button">
                        <i class="fas fa-home mr-2"></i> Home
                    </button>
                    <button class="custom-button primary-button">
                        <i class="fas fa-sign-out-alt mr-2"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Stats Cards with Thymeleaf -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <div class="stat-card p-6 bounce-in">
            <h3 class="text-lg font-semibold text-gray-700">Active Markets</h3>
            <p class="text-3xl font-bold text-green-600" id="activeMarkets" th:text="${#lists.size(marketData)}">0</p>
        </div>
        <div class="stat-card p-6 bounce-in" style="animation-delay: 0.2s">
            <h3 class="text-lg font-semibold text-gray-700">Crop Types</h3>
            <p class="text-3xl font-bold text-green-600" id="cropTypes" th:text="${#sets.size(cropTypes)}">0</p>
        </div>
        <div class="stat-card p-6 bounce-in" style="animation-delay: 0.4s">
            <h3 class="text-lg font-semibold text-gray-700">Avg Price</h3>
            <p class="text-3xl font-bold text-green-600" id="avgPrice" th:text="'₹' + ${avgPrice}">₹0</p>
        </div>
    </div>

    <!-- Main Dashboard Content -->
    <div class="glass-container p-8 mb-8">
        <div class="flex flex-col md:flex-row justify-between items-center">
            <div>
                <h1 class="text-3xl font-bold text-gray-800 mb-2">Farmer's Market Dashboard</h1>
                <p class="text-gray-600">Real-time crop prices and market trends</p>
            </div>
            <div class="mt-4 md:mt-0">
                <span class="bg-green-100 text-green-800 px-4 py-2 rounded-full text-sm font-medium">
                    <i class="fas fa-sync-alt mr-2 animate-spin"></i> Updating Live
                </span>
            </div>
        </div>
    </div>

    <!-- Market Prices Table with Thymeleaf -->
    <div class="table-container relative">
        <div class="p-6 border-b border-gray-200">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <h2 class="text-xl font-semibold text-gray-800 mb-4 md:mb-0">Market Prices</h2>
                <div class="flex space-x-4">
                    <button id="filterBtn" class="custom-button secondary-button">
                        <i class="fas fa-filter mr-2"></i> Filter
                    </button>
                    <div id="filterDropdown" class="filter-dropdown absolute right-4 top-20 hidden">
                        <h3 class="font-semibold text-gray-800 mb-4">Filter Markets</h3>
                        <label for="stateFilter"></label><select id="stateFilter" class="w-full p-3 border rounded-lg mb-4">
                            <option value="">All States</option>
                        <option th:each="state : ${stateMarketData}"
                                th:value="${state}"
                                th:text="${state}"
                                th:selected="${param.state == state}"></option>
                        </select>
                        <button id="applyFilter" class="w-full custom-button primary-button">Apply</button>
                    </div>
                    <button id="exportBtn" class="custom-button secondary-button">
                        <i class="fas fa-download mr-2"></i> Export
                    </button>
                </div>
            </div>
        </div>
        <div class="overflow-x-auto">
            <table class="custom-table" id="marketTable">
                <thead>
                <tr>
                    <th>State</th>
                    <th>District</th>
                    <th>Market</th>
                    <th>Crop</th>
                    <th>Date</th>
                    <th>Min Price</th>
                    <th>Max Price</th>
                    <th>Suggested</th>
                </tr>
                </thead>
                <tbody id="marketTableBody">
                <!-- Thymeleaf loop to display data -->
                <tr th:each="crop : ${marketData}" class="bounce-in">
                    <td th:text="${crop.state}"></td>
                    <td th:text="${crop.district}"></td>
                    <td th:text="${crop.market}"></td>
                    <td th:text="${crop.cropName}"></td>
                    <td th:text="${crop.arrivalDate}"></td>
                    <td class="text-green-600 font-semibold" th:text="'₹' + ${crop.minPrice}"></td>
                    <td class="text-green-600 font-semibold" th:text="'₹' + ${crop.maxPrice}"></td>
                    <td class="text-blue-600 font-semibold" th:text="'₹' + ${crop.suggestedPrice}"></td>
                </tr>
                </tbody>
            </table>
        </div>
        <div class="p-6 text-center">
            <button id="showMoreBtn" class="custom-button primary-button">Show More</button>
        </div>
    </div>
</div>

<script>
    // Pagination and filtering variables
    let displayedRows = 3;
    const rowsPerLoad = 3;
    const allData = /*[[${marketData}]]*/ []; // Pass Thymeleaf data to JS

    // Render table for filtering and pagination
    function renderTable(data, limit) {
        const tbody = document.getElementById('marketTableBody');
        tbody.innerHTML = '';
        const fragment = document.createDocumentFragment();
        const filteredData = data.slice(0, limit);
        filteredData.forEach(crop => {
            const tr = document.createElement('tr');
            tr.classList.add('bounce-in');
            tr.innerHTML = `
                <td>${crop.state}</td>
                <td>${crop.district}</td>
                <td>${crop.market}</td>
                <td>${crop.cropName}</td>
                <td>${crop.arrivalDate}</td>
                <td class="text-green-600 font-semibold">₹${crop.minPrice}</td>
                <td class="text-green-600 font-semibold">₹${crop.maxPrice}</td>
                <td class="text-blue-600 font-semibold">₹${crop.suggestedPrice}</td>
            `;
            fragment.appendChild(tr);
        });
        tbody.appendChild(fragment);
    }

    // CSV export function
    function exportTableToCSV(filename) {
        const table = document.getElementById('marketTable');
        const rows = Array.from(table.querySelectorAll('tr'));
        const csv = [];

        rows.forEach(row => {
            const cols = Array.from(row.querySelectorAll('th, td'));
            const rowData = cols.map(col => `"${col.textContent.trim().replace(/"/g, '""')}"`);
            csv.push(rowData.join(','));
        });

        const csvBlob = new Blob([csv.join('\n')], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(csvBlob);
        const link = document.createElement('a');
        link.href = url;
        link.download = filename;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        URL.revokeObjectURL(url);
    }

    // Event Listeners
    const filterBtn = document.getElementById('filterBtn');
    const filterDropdown = document.getElementById('filterDropdown');
    const applyFilterBtn = document.getElementById('applyFilter');
    const stateFilter = document.getElementById('stateFilter');
    const showMoreBtn = document.getElementById('showMoreBtn');
    const exportBtn = document.getElementById('exportBtn');

    filterBtn.addEventListener('click', () => {
        filterDropdown.classList.toggle('hidden');
    });

    applyFilterBtn.addEventListener('click', () => {
        const state = stateFilter.value;
        const filteredData = state ? allData.filter(item => item.state === state) : allData;
        displayedRows = rowsPerLoad;
        renderTable(filteredData, displayedRows);
        filterDropdown.classList.add('hidden');
    });

    showMoreBtn.addEventListener('click', () => {
        const state = stateFilter.value;
        const filteredData = state ? allData.filter(item => item.state === state) : allData;
        displayedRows += rowsPerLoad;
        renderTable(filteredData, displayedRows);
        if (displayedRows >= filteredData.length) {
            showMoreBtn.style.display = 'none';
        }
    });

    exportBtn.addEventListener('click', () => {
        exportTableToCSV('market_data_' + new Date().toISOString().slice(0,10) + '.csv');
    });

    // Initial render with limited rows
    renderTable(allData, displayedRows);
</script>
</body>
</html>